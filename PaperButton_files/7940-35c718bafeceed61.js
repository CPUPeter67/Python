!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=Error().stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="62d0fb6d-dfd3-4d1c-8a51-203780ac356a",e._sentryDebugIdIdentifier="sentry-dbid-62d0fb6d-dfd3-4d1c-8a51-203780ac356a")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"a8a5682e"};"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7940],{9257:(e,n,t)=>{t.d(n,{Q:()=>eo});var r=t(12694),a=t(81073),i=t(67313),o=t(21462),s=t(66890),l=t(64912),c=t(91326),u=t(96034),d=t(47383),p=t(8985),g=t(58150),m=t(18509),h=t(27023),f=t(11769),v=t(36073),w=t(4616),y=t(78626),b=t(85389),A=t(63456),_=t(67611),S=function(e){var n=e.owner,t=e.currentUserId,r="Org"===n.__typename;return"Org"===n.__typename&&"OrgGroupConnection"===n.groups.__typename&&void 0!==n.groups.items.find(function(e){return"system_viewers"===e.type&&e.isMember})?(0,a.Y)(Y,{orgId:r?n.id:"",orgName:n.name,currentUserId:t}):(0,a.Y)(U,{})},U=function(){return(0,a.Y)(b.S,{children:(0,a.Y)(v.N,{colorway:"warning",text:"You do not have permission to create an app"})})},Y=function(e){var n,t=e.orgId,i=e.orgName,s=e.currentUserId,l=(0,r._)((0,o.useState)(!1),2),c=l[0],u=l[1],m=(0,d.N7)({variables:{orgId:t,upgradeRequestInput:{userId:s,status:"PENDING"}}}),h=m.data,S=m.loading,U=m.error,Y=(0,p.o)({controlName:"flag-viewer-upgrades-downgrades",default:!1}),E=(null==h||null==(n=h.currentUser)?void 0:n.org.__typename)==="Org"&&null!==h.currentUser.org.upgradeRequest;return S?(0,a.Y)(b.S,{css:B.loadingAndErrorWrapper,children:(0,a.Y)(A.A,{})}):U?(0,a.Y)(b.S,{css:B.loadingAndErrorWrapper,children:(0,a.Y)(b.S,{children:(0,a.Y)(v.N,{colorway:"red",text:"Something went wrong."})})}):(0,a.FD)(b.S,{css:B.overlayContainer,gap:16,justify:"center",align:"center",children:[(0,a.Y)(_.A,{size:24}),(0,a.Y)(w.EY,{css:B.overlayText,children:"As a viewer you can access apps but you canâ€™t create them. To create apps, you need to request an upgrade to a full seat from your team admin."}),Y?(0,a.Y)(y.m_,{tooltip:"You already have a pending upgrade request. Please wait for your admin to respond.",isDisabled:!E,children:(0,a.Y)(f.$n,{text:"Request upgrade from admin",isDisabled:E,variant:"default",colorway:"primary",onClick:function(){return u(!0)}})}):null,(0,a.Y)(g.A,{isOpen:c,orgId:t,orgName:i,onClose:function(){return u(!1)},onSuccess:function(){return u(!1)}})]})},B=(0,m.x)({loadingAndErrorWrapper:[h.wp.display.flex,h.wp.flex.growAndShrink(1),h.wp.center],overlayContainer:[h.wp.maxWidth("100%")],overlayText:[h.wp.textAlign.center,h.wp.maxWidth(600),h.wp.colWithGap(8)]}),E=t(12317),k=t(94763),x=t(76334),I=t(17844),C=t(12584),R=t(41114),D=t(86997);function F(){var e=(0,C._)(["\n  query AgentInputReachedHardLimit($orgId: String) {\n    currentUser {\n      id\n      usageInterval {\n        ... on UsageInterval {\n          endDate\n        }\n        ... on Error {\n          message\n        }\n      }\n      org(orgId: $orgId) {\n        ... on Org {\n          id\n          usageInterval {\n            ... on UsageInterval {\n              endDate\n            }\n            ... on Error {\n              message\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return F=function(){return e},e}var T={},P=(0,R.J1)(F()),L=t(6064),N=function(e){var n,t,r,i,o,s,l=e.onIncreaseBudget,c=e.canEditUsageLimit,u=e.orgId,d=void 0!==u,p=d&&!c,g=(n={variables:{orgId:u}},t=(0,I._)({},T,n),D.I(P,t)),m=g.data,h=g.loading,w=g.error;return(r=d?(null==m||null==(i=m.currentUser)?void 0:i.org.__typename)==="Org"&&"UsageInterval"===m.currentUser.org.usageInterval.__typename?m.currentUser.org.usageInterval.endDate:"":(null==m||null==(s=m.currentUser)||null==(o=s.usageInterval)?void 0:o.__typename)==="UsageInterval"?m.currentUser.usageInterval.endDate:"",h)?(0,a.Y)(b.S,{css:q.loadingAndErrorWrapper,children:(0,a.Y)(A.A,{})}):w?(0,a.Y)(b.S,{css:q.loadingAndErrorWrapper,children:(0,a.Y)(b.S,{children:(0,a.Y)(v.N,{colorway:"red",text:"Something went wrong."})})}):(0,a.FD)(b.S,{css:q.overlayContainer,gap:16,align:"center",justify:"center",children:[(0,a.FD)(b.S,{css:q.overlayText,children:[(0,a.Y)(O,{isOrg:d}),(0,a.Y)(M,{isOrg:d,isOrgMemberWithoutEditPermission:p,endOfBillingPeriod:r})]}),p?null:(0,a.Y)(f.$n,{text:"Increase usage budget",onClick:l,iconLeft:(0,a.Y)(L.A,{}),colorway:"primary"})]})},O=function(e){var n=e.isOrg;return(0,a.Y)(w.EY,{css:q.overlayTitle,variant:"subheadDefault",children:n?"Your team has hit its monthly usage budget.":"You've hit your monthly usage budget."})},M=function(e){var n=e.isOrg,t=e.isOrgMemberWithoutEditPermission,r=e.endOfBillingPeriod,i=(0,E.A)(r),o=(0,k.A)(i)?" on ".concat((0,x.A)(i,"MMM do, hh:mm aaa")):"";return n?t?(0,a.FD)(w.EY,{variant:"small",children:["To continue using the Agent now, please contact your team admin to request an increase in the usage budget. Otherwise, your usage will reset",o," when the next billing period begins."]}):(0,a.FD)(w.EY,{variant:"small",children:["To continue using the Agent now, increase your budget. Otherwise, your team's usage will reset",o," when the next billing period begins."]}):(0,a.FD)(w.EY,{children:["To continue using the Agent now, increase your budget. Otherwise, your usage will reset",o," when the next billing period begins."]})},q=(0,m.x)({overlayContainer:[h.wp.maxWidth("100%")],overlayText:[h.wp.textAlign.center,h.wp.maxWidth(800),h.wp.colWithGap(8)],overlayTitle:[h.wp.fontWeight.bold],loadingAndErrorWrapper:[h.wp.display.flex,h.wp.flex.growAndShrink(1),h.wp.center,h.wp.minHeight(200)]}),H=t(29935),z=t(82643),W=t(52631),V=t(66400),$=t(86733),G=t(85144),Z=t(41358),K=t(97153),j=t(94924),J=(0,m.x)({ubbBannedContainer:[h.wp.textAlign.center],buttonContainer:[{"@media (max-width: 600px)":{flexDirection:"column"}}]});function Q(e){var n=e.isSuspended,t=e.context,i=(0,r._)((0,o.useState)(!1),2),s=i[0],l=i[1],c="org"!==t.type||t.canEditPaymentMethod,u=(0,V.hb)("org"===t.type?{type:"org",isAdmin:t.isAdmin,isSuspended:n}:{type:"user",isSuspended:n}),d=u.headingText,p=u.subheadingText;return(0,a.FD)(b.S,{gap:12,align:"center",css:J.ubbBannedContainer,children:[(0,a.Y)(w.EY,{variant:"subheadDefault",children:d}),(0,a.Y)(w.EY,{children:p}),c?(0,a.Y)(Z.ui,{elevated:!0,children:(0,a.FD)(b.S,{row:!0,css:J.buttonContainer,gap:12,children:[(0,a.Y)(b.S,{gap:8,children:(0,a.Y)($.v,{iconLeft:(0,a.Y)(j.A,{}),text:"View and pay invoices",href:"org"===t.type?"/orb-customer-portal/org/".concat(t.orgId):"/orb-customer-portal",target:"_blank"})}),(0,a.Y)(b.S,{gap:8,children:(0,a.Y)(f.$n,{iconLeft:(0,a.Y)(K.A,{}),text:"Update payment method",colorway:"primary",onClick:function(){return l(!0)}})})]})}):null,(0,a.Y)(G.a,{isOpen:s,onRequestClose:function(){return l(!1)},children:(0,a.Y)(W.k,{onDone:function(){l(!1)},onBack:(0,H._)(function(){return(0,z.YH)(this,function(e){return[2,l(!1)]})})})})]})}var X=t(90610),ee=t(70738),en=t(83603),et=t(78008),er=t(30166),ea=t(38580),ei=t(64743);function eo(e){var n=e.agentAccessDeniedReason,t=e.owner,d=e.usageInfo,p=e.currentUserId,g=(0,r._)((0,o.useState)(!1),2),m=g[0],h=g[1],f=(0,en.ET)().orgRole,y=(0,i.useRouter)();return n===X.F.BudgetExceeded?(0,a.FD)(a.FK,{children:[(0,a.Y)(N,{orgId:"Org"===t.__typename?t.id:void 0,canEditUsageLimit:"success"===d.status&&d.canEditUsageLimit,onIncreaseBudget:function(){return h(!0)}}),(0,a.Y)(G.a,{isOpen:m,onRequestClose:function(){return h(!1)},children:(0,a.Y)(er.j,{org:"success"===d.status?d.org:void 0,initialSettings:"success"===d.status?d.usageBasedBillingAlerts:void 0,onDone:function(){return h(!1)}})})]}):n===X.F.FreeAgentUsageQuotaExceeded?(0,a.FD)(b.S,{gap:8,align:"center",children:[(0,a.Y)(w.EY,{color:"dimmer",children:"Youâ€™ve used up your available usage"}),(0,a.Y)(et.A,{context:"agent_freemium_quota",colorway:"primary",variant:"outlined",highlightUpsell:"agent",text:"Upgrade to ".concat(u.en," to continue using ").concat(l.g$)})]}):n===X.F.ErrorDeterminingBudget?(0,a.Y)(b.S,{children:(0,a.Y)(b.S,{children:(0,a.Y)(v.N,{colorway:"red",text:"Error determining remaining budget. Please try again later."})})}):n===X.F.AgentKillswitch?(0,a.Y)(b.S,{children:(0,a.Y)(v.N,{colorway:"red",text:"This feature is currently unavailable. Please try again later."})}):n===X.F.PaymentDelinquent?(0,a.Y)(Q,{isSuspended:!1,context:"Org"===t.__typename?{type:"org",orgId:t.id,isAdmin:f===s.v7.SystemAdmins,canEditPaymentMethod:f===s.v7.SystemAdmins}:{type:"user"}}):n===X.F.FreeReplLimitExceeded?(0,a.FD)(b.S,{gap:12,align:"center",children:[(0,a.Y)(ei.A,{size:32}),(0,a.Y)(w.EY,{variant:"subheadDefault",children:"You've hit your limit of free Apps"}),(0,a.Y)(et.A,{context:"repl_limit_upsell",colorway:"primary",variant:"default",highlightUpsell:"replLimit",text:"Upgrade to ".concat(u.en," for unlimited Apps")})]}):n===X.F.EmailVerificationRequired?(0,a.Y)(ee.A,{onEmailVerified:function(){y.reload()}}):n===X.F.FreemiumTemporarilyUnavailable?(0,a.FD)(b.S,{gap:12,align:"center",children:[(0,a.FD)(w.EY,{variant:"subheadDefault",children:[l.g$," is currently experiencing high demand and is temporarily unavailable for ",u.Lm," plan users."]}),(0,a.FD)(w.EY,{children:["Please try again later, or upgrade to ",u.en," for immediate access."]}),(0,a.Y)(et.A,{context:"agent_freemium_quota",colorway:"primary",variant:"default",highlightUpsell:"agent",text:"Upgrade to ".concat(u.en," to continue using ").concat(l.g$)})]}):n===X.F.NoReplCreationPermissions?(0,a.Y)(S,{owner:t,currentUserId:p}):n===X.F.UserUBBBanned?(0,a.Y)(Q,{isSuspended:!0,context:"Org"===t.__typename?{type:"org",orgId:t.id,isAdmin:f===s.v7.SystemAdmins,canEditPaymentMethod:t.authorizations.editPaymentMethod.isAuthorized}:{type:"user"}}):n===X.F.RequiresPaymentMethod?(0,a.Y)(ea.A,{owner:"Org"===t.__typename?{type:"org",slug:t.slug}:void 0}):void(0,c.A)(n)}},20350:(e,n,t)=>{t.d(n,{A:()=>eC});var r,a=t(83846),i=t(12694),o=t(86105),s=t(81073),l=t(21462),c=t(66340),u=t(64912),d=t(45773),p=t(49069),g=t(37032),m=new g.k(function(e){var n=e.onFirstEdit;return p.sU.define({create:function(){return!1},update:function(e,t){return e||!t.docChanged||void 0===t.annotation(p.ZX.userEvent)?e:(null==n||n(),!0)}})}),h=t(41847),f=t(11297),v=t(54001),w=t(25882),y=t(66905),b=t(59133),A=t(98679),_=t(1982),S=t(7814),U=t(54682),Y=t(19553),B=t(57855),E=t(3846),k=t(43680),x=t(29935),I=t(82643),C=t(40502),R=t(17089),D=t(83070),F=t(85389),T=t(16691),P=t(63456),L=t(91506);function N(e){var n,t,r,a=(n=({view:e.view}).view,t=(0,C.dI)(),{onUndo:function(e){null==n||n.dispatch({changes:{from:0,to:n.state.doc.length,insert:e}})},onEnhance:(r=(0,x._)(function(){var e,r,a,i;return(0,I.YH)(this,function(o){switch(o.label){case 0:return r=null!=(e=null==n?void 0:n.state.doc.toString())?e:"",[4,t.enhancePrompt(r)];case 1:if(!(a=o.sent()).ok||!(i=a.payload))throw Error("Failed to generate prompt");return null==n||n.dispatch({changes:{from:0,to:n.state.doc.length,insert:i.trimStart().trimEnd()}}),(0,R.u4)(R.AZ.AI_ENHANCE_PROMPT_USED,{action:"prompt_enhanced",originalPrompt:r,generatedPrompt:i}),[2,r]}})}),function(){return r.apply(this,arguments)})}),o=a.onUndo,c=a.onEnhance,u=(0,i._)((0,l.useState)(null),2),d=u[0],p=u[1],g=(0,i._)((0,l.useState)({type:"waiting"}),2),m=g[0],h=g[1];return(0,s.FD)(F.S,{row:!0,gap:4,align:"center",children:[null!==d?(0,s.Y)(D.K0,{alt:"Undo",disabled:e.loading,onClick:function(){p(null),o(d)},children:(0,s.Y)(L.A,{})}):null,(0,s.Y)(D.K0,{alt:"Improve prompt",tooltipContents:"Improve prompt",disabled:e.isDisabled||"waiting"!==m.type,onClick:function(){h({type:"generating"}),c().then(function(e){return p(e)}).finally(function(){return h({type:"waiting"})})},children:(0,s.Y)(function(){return"generating"===m.type?(0,s.Y)(P.A,{}):(0,s.Y)(T.A,{})},{})})]})}var O=t(6013),M=t(20701),q=t(51638),H=t(10292),z=t(47045),W=t(12421),V=t(89121),$=t(39685),G=t(16005),Z=t(94734),K=t(81965),j=t(18701),J=t(37624),Q=t(17844),X=t(68264),ee=t(4729),en=t(22012),et=t(59318),er=t(8950),ea=t(41930),ei=t(36937),eo=t(18509),es=t(27023),el=t(47245),ec=t(41358),eu=t(4616),ed=t(24140),ep=t(37565),eg=t(61518),em=t(61590),eh=(0,eo.x)({root:[es.wp.color.foregroundDimmer],label:[es.wp.visuallyHidden],selectButton:[es.wp.reset.button,es.wp.borderRadius("default"),es.wp.flex.row,es.wp.rowWithGap(4),es.wp.cursor.pointer,es.wp.align.center,es.wp.px(6),es.wp.py(4),es.wp.color.foregroundDimmer,es.wp.fontSize(12),{'&[aria-expanded="true"] .chevron':{transform:"rotate(180deg)"},"&:hover":[es.wp.color.foregroundDefault,es.wp.backgroundColor.backgroundHigher]}],pooverSurface:[es.wp.borderRadius(4),es.wp.border({color:ei.LU.outlineDimmest})],buttonPrefixText:[es.wp.color.foregroundDimmest]}),ef=(0,eo.x)({root:[es.wp.px(8),es.wp.py(6),es.wp.rowWithGap(8),es.wp.align.start,es.wp.justify.spaceBetween,es.wp.cursor.pointer,es.wp.hover({backgroundColor:ei.LU.backgroundHighest}),es.wp.borderRadius("default")]}),ev=(0,eo.x)({root:ef.root,rootSelected:[ef.root,es.wp.backgroundColor.backgroundHigher]}),ew={Auto:{icon:(0,s.Y)(em.A,{}),description:"".concat(u.g$," will choose for you")},"Modern web app":(0,Q._)({icon:null},u.Wu[er.qf8.STACK_BLUEPRINT_FULLSTACK_JS]),"Interactive data app":(0,Q._)({icon:null},u.Wu[er.qf8.STACK_BLUEPRINT_STREAMLIT]),"3D game":(0,Q._)({icon:null},u.Wu[er.qf8.STACK_BLUEPRINT_GAMESTACK_JS]),"Web app (Python)":(0,Q._)({icon:null},u.Wu[er.qf8.STACK_BLUEPRINT_FLASK_VANILLA_JS])};function ey(e){var n=e.selectedOption,t=e.onChange,r=(0,ea.a)();return(0,s.Y)(F.S,{css:eh.root,grow:!0,shrink:!0,children:(0,s.FD)(X.l6,{selectedKey:n,onOpenChange:function(e){e&&(0,R.u4)(R.AZ.START_WITH_AI_USED,{action:"stack_select_opened"})},onSelectionChange:function(e){(0,R.u4)(R.AZ.START_WITH_AI_USED,{action:"stack_selected",previousStack:n,newStack:e}),t(e)},children:[(0,s.Y)(el.J,{css:eh.label,children:"App type"}),(0,s.FD)(ee.$,{css:eh.selectButton,children:[(0,s.Y)(eg.A,{}),r?null:(0,s.FD)(s.FK,{children:[(0,s.Y)("span",{css:eh.buttonPrefixText,children:"App type:"}),(0,s.Y)("span",{children:n}),(0,s.Y)(ep.A,{size:12,className:"chevron"})]})]}),(0,s.Y)(en.A,{placement:r?"top":void 0,children:(0,s.Y)(ec.ui,{css:eh.pooverSurface,p:4,elevated:!0,children:(0,s.Y)(et.qF,{"aria-label":"App type",selectionMode:"single",children:Object.entries(ew).map(function(e){var t=(0,i._)(e,1)[0];return(0,s.Y)(et.nh,{id:t,"aria-label":t,children:(0,s.Y)(eb,{type:t,isSelected:n===t})},t)})})})})]})})}function eb(e){var n=e.type,t=e.isSelected,r=ew[n],a=r.icon,i=r.description;return(0,s.FD)(F.S,{css:t?ev.rootSelected:ev.root,children:[(0,s.FD)(F.S,{grow:!0,pr:24,children:[(0,s.FD)(F.S,{row:!0,gap:6,align:"center",children:[(0,s.Y)(eu.EY,{children:n}),a?(0,s.Y)(F.S,{children:a}):null]}),(0,s.Y)(F.S,{row:!0,gap:4,align:"center",children:(0,s.Y)(eu.EY,{variant:"small",color:"dimmer",children:i})})]}),t?(0,s.Y)(ed.A,{color:ei.LU.greenStrongest}):null]})}var eA=t(42793),e_=t(85051),eS=t(15311),eU=t(78626),eY=(0,eS.v)(["hoverBorderColor","focusedBorderColor"]),eB=eY.cssVars,eE=eY.styleTokens,ek=(0,eA.i7)({from:{opacity:0},to:{opacity:1}}),ex=(0,eo.x)({wrapper:[es.wp.position.relative,es.wp.minHeight("fit-content"),{display:"grid",gridTemplate:"1fr / 1fr","& > *":{gridArea:"1 / 1"}}],surface:[e_.b.filledAndOutlined,es.wp.borderRadius(6),es.wp.flex.growAndShrink(1),es.wp.p(4),{rowGap:ei.LU.space4,display:"flex",flexDirection:"column","&[disabled], &[aria-disabled]":{"& .cm-editor":{opacity:.5}},"@media (hover: hover)":{":not([disabled], [aria-disabled])":{cursor:"text"}},"&:hover:not([disabled], [aria-disabled]):hover":{borderColor:eE.hoverBorderColor},"&:focus-within:not([disabled], [aria-disabled])":{borderColor:eE.focusedBorderColor}}],codemirror:[es.wp.display.flex,es.wp.flex.grow(1),es.wp.overflow("auto"),es.wp.maxHeight(300),{"& .cm-editor":[es.wp.flex.grow(1)]}],attachments:[es.wp.px(4),es.wp.py(6)],primaryButtonGroup:[es.wp.height(32)],submitButton:[es.wp.borderRadius()],overlayBackground:[es.wp.borderRadius(4),es.wp.minHeight("100%"),es.wp.height("fit-content"),{backgroundColor:ei.LU.backgroundDefault,zIndex:1,display:"flex",flexDirection:"column",animation:"".concat(ek," 300ms ease-in-out")}],overlayContent:[es.wp.display.flex,es.wp.flex.column,es.wp.align.center,es.wp.justify.center,es.wp.p(24),es.wp.height("100%"),es.wp.flex.grow(1),{pointerEvents:"auto"}]}),eI=d.Lz.theme((r={"&":{flexGrow:1},"& .cm-content":{fontFamily:ei.LU.fontFamilyDefault}},(0,a._)(r,"& .".concat(b.Fb),{display:"none"}),(0,a._)(r,"& .cm-cursor",{borderLeftColor:ei.LU.foregroundDefault,borderLeftWidth:"1px"}),r));function eC(e){var n,t,r,d,p=(0,y.A)(),g=p.ref,b=p.view,x=(0,c.wR)(),I=(0,U.m5)(),C=null!=(n=e.status)?n:"composing",R=(0,v.Vn)(b,J.Im),D=(0,_.A)().showError,T=(0,J.hk)({text:null!=(t=e.placeholderText)?t:"Message Agentâ€¦"}),P=j.bZ.use(2e3),L=(0,i._)((0,l.useState)("Auto"),2),Q=L[0],X=L[1],ee=(0,q.j)(e.persistenceKey,b),en=ee.persistPromptDraftCompartment,et=ee.clearPersistedPromptDraft,er=(0,z.e)(),ea=(0,G.s)(),eo=ea.attachments,es=ea.urlAttachments,el=ea.removeAttachment,eu=ea.addAttachments,ed=ea.addUrlAttachment,ep=ea.removeUrlAttachment,eg=ea.clearAttachments,em=ea.isLoading,eh=null!=(r=(0,v.Vn)(b,M.Wd))?r:[],ef=(0,l.useCallback)(function(e){b&&b.dispatch(b.state.update({changes:{from:0,to:b.state.doc.length,insert:e}}))},[b]),ev=(0,K.A)({addAttachments:eu}),ew=ev.isDraggedOver,eb=ev.drop,eA=R&&0===eo.length&&"composing"===C||"loading"===C||e.isSubmitDisabled||!!e.disabled||em,e_=em?"Please wait for files to finish uploading":e.submitDisabledReason,eS=e.onUpsell,eY=e.onSubmit,eE=e.disableClearOnSubmit,ek=(0,l.useCallback)(function(){if("loading"!==C){if(eA||!b){e.isSubmitDisabled&&eS&&eS();return}var n=b.state.doc.toString();et(),eY(n,(0,o._)(eo).concat((0,o._)(es.map(function(e){return e.file}))),"Auto"===Q?void 0:(0,u.tK)(Q)),eE||(eg(),b.dispatch({effects:M.Ff.of(null)}),b.dispatch({changes:{from:0,to:b.state.doc.length}}))}},[eA,eS,b,et,e.isSubmitDisabled,eY,eo,eE,eg,es,Q,C]),eC=(0,A.A)(ek),eD=eR.use({onSubmit:(0,l.useCallback)(function(){return eC.current()},[eC])}),eF=(0,H.F)({view:b,setPromptEditor:e.inputRef}),eT=O.U.use({addAttachments:eu,onAutoAttachedLargePaste:function(e){(0,$.p)({action:"auto_attached_large_paste",fileSize:e})}}),eP=m.use({onFirstEdit:function(){var n;null==(n=e.onFirstEdit)||n.call(e)}}),eL=(0,S.S)([eb,eF],{breadcrumb:"client/workspace/components/Agent/Chat/InputBox/index.tsx:448"});return(0,s.FD)(F.S,{css:ex.wrapper,children:[(0,s.FD)(ec.ui,{css:ex.surface,innerRef:eL,gap:4,style:(d={borderColor:ew?ei.LU.accentPrimaryDefault:ei.LU.outlineDimmer},(0,a._)(d,eB.focusedBorderColor,ei.LU.accentPrimaryDefault),(0,a._)(d,eB.hoverBorderColor,ei.LU.accentPrimaryDefault),d),"aria-hidden":!e.overlay,"aria-disabled":!!e.disabled||void 0,inert:e.overlay?"true":void 0,onClick:function(e){e.target===e.currentTarget&&(null==b||b.focus())},children:[(0,s.FD)(F.S,{grow:!0,shrink:!0,gap:4,children:[(0,s.Y)(B.A,{css:ex.attachments,detectedUrls:eh.map(function(e){return(0,s.Y)(E.A,{url:e,addUrlAttachment:ed,removeUrlAttachment:ep,onError:D},e)}),fileAttachments:eo.map(function(e){return(0,s.Y)(k.m1,{attachment:e,removeAttachment:el,getAttachmentTypeDisclaimer:(0,W.F)({aiName:(0,u.Nn)({capitalizeFirstChar:!0})})},e.path)})}),x?(0,s.Y)(F.S,{style:{minHeight:e.minHeight?"".concat(e.minHeight,"px"):void 0}}):(0,s.Y)(w.A,{"data-chromatic":"ignore",ref:g,css:ex.codemirror,style:{minHeight:e.minHeight?"".concat(e.minHeight,"px"):void 0,maxHeight:e.maxHeight?e.maxHeight:void 0},fontSize:14,readOnly:e.disabled,extensions:[eI,eD,eT,T,j.tP,P,en,f.r,h.N,eP,er?[]:M.fd],id:"ai-prompt-input","data-cy":"ai-prompt-input"})]}),(0,s.FD)(F.S,{row:!0,gap:4,css:ex.primaryButtonGroup,px:2,pb:2,justify:"space-between",align:"end",onClick:function(e){e.target===e.currentTarget&&(null==b||b.focus())},children:[(0,s.FD)(F.S,{row:!0,gap:I?12:4,align:"center",children:[(0,s.Y)(ey,{selectedOption:Q,onChange:X}),(0,s.Y)(ec.ui,{elevated:!0,children:(0,s.Y)(Y.e,{disabled:e.disabled,status:C,addAttachments:eu})}),(0,s.Y)(V.A,{getCurrentText:function(){var e;return null!=(e=null==b?void 0:b.state.doc.toString())?e:""},onUpdateText:ef})]}),(0,s.FD)(F.S,{align:"center",row:!0,gap:8,children:[b?(0,s.Y)(ec.ui,{elevated:!0,children:(0,s.Y)(N,{isDisabled:e.disabled||null==R||R,view:b})}):null,I&&!e.renderSubmitButton?(0,s.Y)(Z.J,{loading:"loading"===C,variant:"agent",alt:"composing"===C?"Send":"Loadingâ€¦",disabled:eA,onClick:ek,dataCy:"ai-prompt-submit"}):(0,s.Y)(ec.ui,{elevated:!0,css:ex.submitButton,children:(0,s.Y)(eU.m_,{isDisabled:!e_,tooltip:e_,children:e.renderSubmitButton({onSubmit:ek,disabled:eA})})})]})]})]}),e.overlay?(0,s.Y)(F.S,{css:ex.overlayBackground,children:(0,s.Y)(F.S,{css:ex.overlayContent,children:e.overlay})}):null]})}var eR=new g.k(function(e){var n=e.onSubmit,t=e.preventSubmitOnEnter;return d.Lz.domEventHandlers({keydown:function(e){!t&&("Enter"===e.key&&e.metaKey&&e.stopPropagation(),"Enter"!==e.key||e.shiftKey||(e.preventDefault(),n()))}})})},31022:(e,n,t)=>{t.d(n,{U:()=>G});var r,a=t(29935),i=t(86105),o=t(82643),s=t(81073),l=t(21462),c=t(17089),u=t(18509),d=t(27023),p=t(11769),g=(0,u.x)({button:[d.wp.borderRadius(16)]});function m(e){var n=e.item,t=e.onSelect;return(0,s.Y)(p.$n,{css:g.button,iconLeft:n.icon,text:n.title,onClick:function(){t(n),(0,c.u4)(c.AZ.START_WITH_AI_USED,{action:"sample_prompt_selected",prompt:n.prompt,title:n.title})}})}var h=t(83846),f=t(12694),v=t(59597),w=t(36937),y=t(83070),b=t(85389),A=t(50746),_=t(54613),S=[d.wp.position.absolute,d.wp.zIndex(2),d.wp.top("50%"),{transform:"translateY(-50%)"},{backgroundColor:w.LU.backgroundRoot,boxShadow:"0 0 8px ".concat(w.LU.backgroundRoot)}],U=(0,i._)(S).concat([{left:0}]),Y=(0,i._)(S).concat([{right:0}]),B=(0,u.x)({scrollAreaRoot:[d.wp.flex.row,d.wp.align.center,d.wp.justify.center,d.wp.overflowX("hidden"),d.wp.overflowY("hidden"),{"--scrollbar-size":"0px"},d.wp.position.relative,{'&[data-left-shadow="true"]::before, &[data-right-shadow="true"]::after':{content:'""',position:"absolute",top:0,bottom:0,width:"80px",zIndex:1,pointerEvents:"none"},'&[data-left-shadow="true"]::before':{left:0,background:"linear-gradient(to right, ".concat(w.LU.backgroundRoot," ").concat(40,"px, transparent)")},'&[data-right-shadow="true"]::after':{right:0,background:"linear-gradient(to left, ".concat(w.LU.backgroundRoot," ").concat(40,"px, transparent)")}}],scrollAreaViewport:[d.wp.height("100%"),{"& > div":{height:"100%",width:"max-content",display:"block !important"}}],scrollAreaScrollbar:[d.wp.display.none],scrollAreaThumb:[d.wp.flex.grow(1),d.wp.backgroundColor.outlineDimmest,d.wp.borderRadius(4),d.wp.position.relative,{"&::before":{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"100%",height:"100%",minWidth:"44px",minHeight:"44px"}}],container:[d.wp.position.relative,d.wp.width("100%")],wrapper:[d.wp.height("fit-content"),d.wp.px(2),d.wp.rowWithGap(12),d.wp.flex.wrap,d.wp.align.center,(r={},(0,h._)(r,"--color",w.LU.foregroundDimmer),(0,h._)(r,"&:hover, &:focus-within",(0,h._)({},"--color",w.LU.foregroundDefault)),(0,h._)(r,"& *",{transition:"color 0.2s ease-in-out"}),r),d.wp.position.relative]});function E(e){var n=e.children,t=(0,f._)((0,l.useState)(!1),2),r=t[0],a=t[1],i=(0,f._)((0,l.useState)(!1),2),o=i[0],c=i[1],u=(0,l.useRef)(null),d=(0,l.useRef)(null),p=(0,l.useCallback)(function(){var e=d.current;if(e){var n=e.scrollLeft,t=e.scrollWidth,r=e.clientWidth;a(n>0),c(n<t-r-1)}},[]),g=(0,l.useCallback)(function(){var e=d.current;e&&e.scrollBy({left:-200,behavior:"smooth"})},[]),m=(0,l.useCallback)(function(){var e=d.current;e&&e.scrollBy({left:200,behavior:"smooth"})},[]);return(0,l.useEffect)(function(){var e=d.current;if(e)return p(),e.addEventListener("scroll",p),window.addEventListener("resize",p),function(){e.removeEventListener("scroll",p),window.removeEventListener("resize",p)}},[p]),(0,s.FD)("div",{css:B.container,children:[r?(0,s.Y)(y.K0,{onClick:g,css:U,"aria-label":"Previous",alt:"Previous",size:28,children:(0,s.Y)(A.A,{})}):null,o?(0,s.Y)(y.K0,{onClick:m,css:Y,"aria-label":"Next",alt:"Next",size:28,children:(0,s.Y)(_.A,{})}):null,(0,s.FD)(v.bL,{css:B.scrollAreaRoot,ref:u,"data-left-shadow":r,"data-right-shadow":o,children:[(0,s.Y)(v.LM,{css:B.scrollAreaViewport,ref:d,children:(0,s.Y)(b.S,{css:B.wrapper,children:n})}),(0,s.Y)(v.Ze,{css:B.scrollAreaScrollbar,orientation:"horizontal",children:(0,s.Y)(v.zi,{css:B.scrollAreaThumb})})]})]})}var k=t(94887),x=t(17844),I=t(93629),C=t(52351),R=t(4163),D=t(32846),F=t(47630),T=t(12360),P=t(83728),L=t(80864),N=t(12813),O=t(36734),M=t(49748),q=t(1193),H=t(80923),z=t(47820),W=[{title:"Local landmarks map",prompt:"Make an app that displays a map of local landmarks based on the current viewable area of the map. Use Wikipedia to get the landmarks. Add custom markers with hover effects and a sleek sidebar showing landmark details.",icon:(0,s.Y)(H.A,{})},{title:"Stock analysis",prompt:"Make an app that lets me input a stock symbol and get a summary of financial data. Include a table and chart tracking the stock price and other key financial information. Use data from Yahoo Finance and let me download the table data as a CSV. Design it with a dark theme and interactive charts.",icon:(0,s.Y)(function(e){return(0,s.Y)(C.Ay,(0,I._)((0,x._)({},e),{children:(0,s.Y)("path",{fillRule:"evenodd",d:"M12 3.25a.75.75 0 0 1 .75.75v16a.75.75 0 0 1-1.5 0V4a.75.75 0 0 1 .75-.75Zm6 6a.75.75 0 0 1 .75.75v10a.75.75 0 0 1-1.5 0V10a.75.75 0 0 1 .75-.75Zm-12 4a.75.75 0 0 1 .75.75v6a.75.75 0 0 1-1.5 0v-6a.75.75 0 0 1 .75-.75Z",clipRule:"evenodd"})}))},{})},{title:"Waitlist website",prompt:"Make a waitlist site for my startup that collects emails and full names from users. Include some basic information about my startup and make the design modern and professional. Use a postgres database to store the registrations. Design it with a beautiful hero section and elegant glass-like elements.",icon:(0,s.Y)(q.A,{})},{title:"AI chat",prompt:"Make an AI chat application. Style it with modern chat bubbles, typing indicators, and a clean gradient background with a floating message input.",icon:(0,s.Y)(F.A,{})},{title:"Book scanner",prompt:"Make an app that lets me upload an image of my bookshelf and get a list of all the books in the picture along with some details. Design it with a drag-and-drop upload area and display results in beautiful cards with book covers.",icon:(0,s.Y)(R.A,{})},{title:"Link in bio",prompt:"Make a link in bio app that presents all my social accounts in an easy, intuitive, and aesthetic interface. Use a random image for a profile picture placeholder for now. Add hover effects on buttons, a modern card layout, and customizable color themes.",icon:(0,s.Y)(M.A,{})},{title:"Statistical significance calculator",prompt:"Make a web app that lets me input information from an A/B test and tells me whether it's statistically significant. Design it with modern form styling, color-coded results (green for significant, red for not significant), and clear result displays.",icon:(0,s.Y)(L.A,{})},{title:"Personal blog",prompt:"Make a modern personal blog website with a minimalist design and homepage displaying recent posts in a grid layout. Add a text editor for writing posts that supports markdown formatting and image uploads. Each post should have its own page with a comments section and social sharing buttons.",icon:(0,s.Y)(P.A,{})},{title:"Workout tracker",prompt:"Make an app that helps users stay motivated and track their workout progress. Create a clean, simple interface where users can log their exercises by searching or selecting from common workout types like cardio, strength training, and yoga. The app should display workout history in a calendar view and show progress charts for key metrics like weight lifted, running pace, or workout frequency. Design it to work smoothly on both phones and computers.",icon:(0,s.Y)(k.A,{})},{title:"Appointment scheduler",prompt:"Make a booking website where clients can see your availability and schedule appointments. Send automatic confirmation emails and reminders. Design it with a clean calendar interface and modern booking flow.",icon:(0,s.Y)(D.A,{})},{title:"Meditation timer",prompt:"Make a peaceful meditation app with customizable ambient sounds, interval bells, and session tracking. Include guided breathing animations and a serene, minimalist design.",icon:(0,s.Y)(O.A,{})},{title:"Smart meal planner",prompt:"Make a helpful cooking companion that turns your available ingredients into delicious meal ideas. Enter what's in your kitchen and get personalized recipes that use what you have, reduce food waste, and make weeknight cooking easier. Include options to save favorite recipes and generate shopping lists for missing ingredients.",icon:(0,s.Y)(T.A,{})},{title:"Gym buddy finder",prompt:"Make an app that helps gym-goers find new friends to train with. Create profiles with fitness goals and preferences, match users based on location and workout types, and include a messaging system. Design it with vibrant colors and an engaging social interface.",icon:(0,s.Y)(z.A,{})},{title:"Home renovation marketplace",prompt:"Make an app that helps home owners and property managers connect with contractors to place bids on home renovation projects. Include project posting, contractor profiles, bid management, and messaging. Design it with a professional, trustworthy interface.",icon:(0,s.Y)(N.A,{})}],V=(0,t(42793).i7)({from:{opacity:0},to:{opacity:1}}),$=(0,u.x)({emptyContainer:[d.wp.minHeight(32)],container:[{animation:"".concat(V," 400ms ease-out")}]});function G(e){var n,t,r=e.hasCreationAccess,c=e.onSelected,u=(0,l.useMemo)(function(){return(0,i._)(W).sort(function(){return .5-Math.random()}).slice(0,3)},[]),d=(n=(0,a._)(function(e){return(0,o.YH)(this,function(n){return c(e.prompt),[2]})}),function(e){return n.apply(this,arguments)}),p=(t=(0,a._)(function(e){return(0,o.YH)(this,function(n){return[2,d(e)]})}),function(e){return t.apply(this,arguments)});return r?(0,s.Y)(b.S,{css:$.container,grow:!0,shrink:!0,children:(0,s.Y)(E,{children:u.map(function(e){return(0,s.Y)(m,{item:e,onSelect:function(e){return p(e)}},e.title)})})}):(0,s.Y)(b.S,{css:$.emptyContainer})}},35073:(e,n,t)=>{t.d(n,{u9:()=>p,Pz:()=>u});var r=t(29935),a=t(82643),i=function(){var e=(0,r._)(function(e){var n,t,r;return(0,a.YH)(this,function(a){return n=e.dbName,t=e.version,r=e.onUpgrade,[2,new Promise(function(e,a){var i=indexedDB.open(n,t);i.onerror=function(){var e;return a(Error("Failed to open database: ".concat(null==(e=i.error)?void 0:e.message)))},i.onsuccess=function(){return e(i.result)},r&&(i.onupgradeneeded=function(e){var n=e.target;n instanceof IDBOpenDBRequest&&n.result?r(n.result):a(Error("Invalid target during upgrade."))})})]})});return function(n){return e.apply(this,arguments)}}(),o=function(){var e=(0,r._)(function(e){var n,t,r,i;return(0,a.YH)(this,function(a){return n=e.db,t=e.storeName,r=e.mode,i=e.operation,[2,new Promise(function(e,a){if(!n.objectStoreNames.contains(t))return a(Error('Object store "'.concat(t,'" does not exist in the database.')));var o=n.transaction([t],r),s=i(o.objectStore(t));s.onsuccess=function(){return e(s.result)},s.onerror=function(){var e;return a(Error("Transaction error: ".concat(null==(e=s.error)?void 0:e.message)))},o.onabort=function(){return a(Error("Transaction was aborted."))},o.onerror=function(){return a(Error("Transaction encountered an error."))}})]})});return function(n){return e.apply(this,arguments)}}(),s="LandingPageAgentAttachments",l=null,c=function(){var e=(0,r._)(function(){return(0,a.YH)(this,function(e){return l?[2,l]:[2,l=i({dbName:"ReplitAgentAttachments",version:1,onUpgrade:function(e){e.objectStoreNames.contains(s)||e.createObjectStore(s,{keyPath:"id",autoIncrement:!0})}})]})});return function(){return e.apply(this,arguments)}}(),u=function(){var e=(0,r._)(function(){return(0,a.YH)(this,function(e){switch(e.label){case 0:return[4,c()];case 1:var n;return[2,o({db:(n={db:e.sent(),storeName:s}).db,storeName:n.storeName,mode:"readonly",operation:function(e){return e.getAll()}})]}})});return function(){return e.apply(this,arguments)}}(),d=function(){var e=(0,r._)(function(){return(0,a.YH)(this,function(e){switch(e.label){case 0:return[4,c()];case 1:var n;return[2,o({db:(n={db:e.sent(),storeName:s}).db,storeName:n.storeName,mode:"readwrite",operation:function(e){return e.clear()}})]}})});return function(){return e.apply(this,arguments)}}(),p=function(){var e=(0,r._)(function(){return(0,a.YH)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,d()];case 1:return e.sent(),[3,3];case 2:return e.sent(),[2];case 3:return[2]}})});return function(){return e.apply(this,arguments)}}()},37940:(e,n,t)=>{t.d(n,{k:()=>T,q:()=>P});var r=t(29935),a=t(83846),i=t(12694),o=t(82643),s=t(81073),l=t(67313),c=t(21462),u=t(31022),d=t(9257),p=t(20350),g=t(90610),m=t(69271),h=t(93203),f=t(22464),v=t(12032),w=t(83603),y=t(17548),b=t(21762),A=t(92557),_=t(24228),S=t(17089),U=t(16005),Y=t(20341),B=t(18509),E=t(27023),k=t(11769),x=t(4616),I=t(85389),C=t(22568),R=t(63456),D=t(25650),F=(0,B.x)({centeredTitle:[E.wp.center,E.wp.py(12),(0,a._)({},E.$_.max("tabletMin"),[E.wp.py(0)])],label:[E.wp.flex.column,E.wp.gap(6)],title:[(0,a._)({},E.$_.max("tabletMin"),[E.wp.fontSize(18)])],submitButton:[(0,a._)({},E.$_.max("tabletMin"),{"div span":[E.wp.display.none],"div svg":[E.wp.mr(0)]})]});function T(e){var n,t,a,B,E=e.initialPrompt,T=e.currentUser,L=e.onUpsell,N=(0,l.useRouter)(),O=(0,w.ET)().orgId,M=(0,i._)((0,f.p)(T,O,{includeLegacyTeams:!1}),1)[0],q=(0,v.d)(M,void 0).isPrivate,H=(0,m.y)(),z=(0,g.H)(M,H),W=(0,h.M)({currentUser:T}),V=W.createAgentRepl,$=W.status,G=W.agentPromptRiverConnectionStatus,Z=(0,_.e)();(0,y.S)(function(){(0,S.u4)(S.AZ.EXPERIMENT_VARIANT_ASSIGNED,{experiment_name:"flag-visual-plan-creation",variant:Z})});var K=P({createReplStatus:$,hasVisualPlanCreationFlag:Z}),j="/new"===N.pathname,J=(n=(0,r._)(function(e){var n,t;return(0,o.YH)(this,function(r){return n=e.prompt,t=e.attachments,V({prompt:n,attachments:null!=t?t:[],requestedStackBlueprint:e.requestedStackBlueprint,isPrivate:q,teamId:"Team"===M.__typename?M.id:void 0,orgId:"Org"===M.__typename?M.id:void 0}),[2]})}),function(e){return n.apply(this,arguments)}),Q=(0,i._)((0,c.useState)(null),2),X=Q[0],ee=Q[1],en=(0,A.A)();(0,c.useEffect)(function(){!en&&X&&X.focus()},[X,en]),(0,c.useEffect)(function(){E&&X&&X.setValue(E)},[E,X]);var et=!z.loading&&!z.hasAccess,er=(0,b._P)({controlName:"flag-spice-melange",type:"string",default:"medium"});(0,y.S)(function(){(0,S.u4)(S.AZ.EXPERIMENT_VARIANT_ASSIGNED,{experimentName:"flag-spice-melange",variant:er})});var ea=(0,b._P)({controlName:"flag-top-portkey"});return(0,y.S)(function(){(0,S.u4)(S.AZ.EXPERIMENT_VARIANT_ASSIGNED,{experiment_name:"flag-top-portkey",variant:ea})}),(0,s.FD)(I.S,{gap:12,children:[(0,s.Y)(Y.A,{isOpen:"error"===G||"closed"===G,text:"Unable to establish a connection to the AI service. Please refresh the page to continue.",disableHomeButton:!0}),j?null:(0,s.Y)(I.S,{css:F.centeredTitle,row:!0,align:"center",gap:12,children:(0,s.Y)("label",{htmlFor:"ai-prompt-input",css:F.label,children:(0,s.FD)(x.Y9,{css:F.title,level:1,variant:"headerDefault",children:["Hi ",null!=(B=null==(a=T.firstName)?void 0:a.trim())?B:"@"+T.username,", what do you want to make?"]})})}),(0,s.Y)(C.A,{children:(0,s.Y)(U.S,{children:(0,s.Y)(p.A,{inputRef:ee,persistenceKey:"start-with-ai-input-".concat(T.id),minHeight:84,onSubmit:(t=(0,r._)(function(e,n,t){return(0,o.YH)(this,function(r){switch(r.label){case 0:return(0,S.u4)(S.AZ.START_WITH_AI_USED,{action:"prompt_submitted"}),[4,J({prompt:e,attachments:n,requestedStackBlueprint:t})];case 1:return r.sent(),[2]}})}),function(e,n,r){return t.apply(this,arguments)}),placeholderText:"Describe an app or site you want to createâ€¦",disableClearOnSubmit:!0,status:"idle"!==$||z.loading||"connecting"===G?"loading":"composing",isSubmitDisabled:!z.hasAccess||"error"===G||"connecting"===G,submitDisabledReason:z.loading?"Loading...":z.hasAccess?null:z.accessDeniedReason,onUpsell:L,overlay:et?(0,s.Y)(d.Q,{agentAccessDeniedReason:z.accessDeniedReason,owner:M,usageInfo:H,currentUserId:T.id}):void 0,renderSubmitButton:function(e){var n=e.onSubmit,t=e.disabled;return(0,s.Y)(k.$n,{text:K,colorway:"primary",dataCy:"ai-prompt-submit",iconLeft:("Start building"===K||"Start chat"===K)&&"connecting"!==G?(0,s.Y)(D.A,{}):(0,s.Y)(R.A,{}),css:F.submitButton,onClick:n,disabled:t||!z.hasAccess})},onFirstEdit:function(){(0,S.u4)(S.AZ.START_WITH_AI_USED,{action:"agent_input_edited"})}})})}),(0,s.Y)(u.U,{onSelected:function(e){null==X||X.setValue(e),null==X||X.focus()},hasCreationAccess:z.hasAccess})]})}function P(e){var n=e.createReplStatus,t=e.hasVisualPlanCreationFlag;return"creating_repl"===n?"Creating Appâ€¦":"configuring_repl"===n?"Configuring Appâ€¦":"opening_repl"===n?"Opening Appâ€¦":t?"Start chat":"Start building"}},54393:(e,n,t)=>{t.d(n,{B:()=>a});var r=t(90629);function a(e,n){return r.v4(function(t){t.setTag("start-with-ai",!0),n&&t.setExtras(n),r.Cp(e)}),e}},69271:(e,n,t)=>{t.d(n,{a:()=>o,y:()=>i});var r=t(94301),a=t(83603);function i(){var e,n,t,i,o,s,l,c,u,d,p=(0,a.ET)().orgId,g=void 0!==p,m=(0,r.jQ)({variables:{orgId:p},context:{noBatch:!0},ssr:!1}),h=m.data,f=m.loading,v=m.error;if(f)return{status:"loading"};var w=!0;g?(e=null!=h&&!!h.currentUser&&"Org"===h.currentUser.org.__typename&&(null==(i=h.currentUser.org.usageBasedBillingBudget)?void 0:i.__typename)==="UsageBasedBillingBudget"&&h.currentUser.org.usageBasedBillingBudget.hasReachedBudget,w=null!=h&&!!h.currentUser&&"Org"===h.currentUser.org.__typename&&(null==(o=h.currentUser.org.authorizations)?void 0:o.__typename)==="OrgAuthorizations"&&h.currentUser.org.authorizations.editUsageLimit.isAuthorized,n=(null==h||null==(s=h.currentUser)?void 0:s.org.__typename)==="Org"?h.currentUser.org:void 0,t=(null==h||null==(l=h.currentUser)?void 0:l.org.__typename)==="Org"&&(null==(c=h.currentUser.org.usageBasedBillingAlerts)?void 0:c.__typename)==="UsageBasedBillingAlertsConfig"?h.currentUser.org.usageBasedBillingAlerts:void 0):(e=null!=h&&!!h.currentUser&&(null==(u=h.currentUser.usageBasedBillingBudget)?void 0:u.__typename)==="UsageBasedBillingBudget"&&h.currentUser.usageBasedBillingBudget.hasReachedBudget,t=(null==h||null==(d=h.currentUser)?void 0:d.usageBasedBillingAlerts.__typename)==="UsageBasedBillingAlertsConfig"?h.currentUser.usageBasedBillingAlerts:void 0);var y=v?"Failed to load usage data":void 0;return y?{status:"error",error:y}:{status:"success",hasReachedBudget:e,canEditUsageLimit:w,org:n,usageBasedBillingAlerts:t}}function o(e){return"CurrentUser"===e.__typename?"OrgAuthorizations"===e.personalOrgAuthorizations.__typename?e.personalOrgAuthorizations:void 0:"Org"===e.__typename?e.authorizations:void 0}},80923:(e,n,t)=>{t.d(n,{A:()=>s});var r=t(17844),a=t(93629),i=t(81073),o=t(52351);function s(e){return(0,i.Y)(o.Ay,(0,a._)((0,r._)({},e),{children:(0,i.Y)("path",{fillRule:"evenodd",d:"M12 1.75A8.25 8.25 0 0 0 3.75 10c0 3.198 2.074 6.266 4.294 8.61A29.677 29.677 0 0 0 12 22.082a29.672 29.672 0 0 0 3.956-3.473c2.22-2.344 4.294-5.411 4.294-8.61A8.25 8.25 0 0 0 12 1.75Zm-.528 21.798-.298-.211a31.168 31.168 0 0 1-4.219-3.696C4.676 17.234 2.25 13.8 2.25 10a9.75 9.75 0 0 1 19.5 0c0 3.802-2.426 7.234-4.706 9.64a31.173 31.173 0 0 1-4.218 3.697c-.127.091-.228.162-.298.21-.16.11-.328.203-.528.203s-.37-.093-.528-.203ZM12 7.75a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5ZM8.25 10a3.75 3.75 0 1 1 7.5 0 3.75 3.75 0 0 1-7.5 0Z",clipRule:"evenodd"})}))}},90610:(e,n,t)=>{t.d(n,{F:()=>h,H:()=>f});var r=t(66890),a=t(69271),i=t(81866),o=t(21762),s=t(17844),l=t(12584),c=t(41114),u=t(86997);function d(){var e=(0,l._)(["\n  query IsUBBBanned($orgId: String) {\n    currentUser {\n      id\n      isUBBBanned\n      org(orgId: $orgId) {\n        ... on Org {\n          id\n          isUBBBanned\n        }\n      }\n    }\n  }\n"]);return d=function(){return e},e}var p={},g=(0,c.J1)(d()),m=t(35990),h=function(e){return e.AgentKillswitch="Agent killswitch",e.ErrorDeterminingBudget="Error determining budget",e.BudgetExceeded="Budget exceeded",e.EmailVerificationRequired="Email verification required",e.FreeAgentUsageQuotaExceeded="Free Agent usage quota exceeded",e.FreeReplLimitExceeded="Free Repl limit exceeded",e.FreemiumTemporarilyUnavailable="Freemium temporarily unavailable",e.NoReplCreationPermissions="No Repl creation permissions",e.UserUBBBanned="User is UBB Banned",e.RequiresPaymentMethod="Requires payment method",e.PaymentDelinquent="Failed payment. Update payment method to continue using Agent.",e}({});function f(e,n){var t,l,c,d,h,f,v,w,y,b,A=(0,m.i)(),_=A.agentUsage,S=A.loading,U="Org"===e.__typename?e.id:void 0,Y=(0,a.a)(e),B=(w=(h={variables:{orgId:U}},f=(0,s._)({},p,h),v=u.I(g,f)).data,y=v.loading,b=v.refetch,{loading:y,isUBBBanned:(null==w||null==(t=w.currentUser)?void 0:t.org.__typename)==="Org"?null==w||null==(c=w.currentUser)||null==(l=c.org)?void 0:l.isUBBBanned:null==w||null==(d=w.currentUser)?void 0:d.isUBBBanned,refetchBanStatus:b}),E=B.loading,k=B.isUBBBanned,x=(0,i.g)(),I=(0,o._P)({controlName:"flag-killswitch-agent"}),C=(0,o._P)({controlName:"flag-freemium-ai-load-shedder"}),R="CurrentUser"===e.__typename&&!e.isSubscribed,D="Org"===e.__typename&&!e.authorizations.createPrivateRepl.isAuthorized&&!e.authorizations.createPublicRepl.isAuthorized;return!Y||S||"loading"===n.status||"loading"===x.type||E?{loading:!0,hasAccess:!1}:I?{loading:!1,hasAccess:!1,accessDeniedReason:"Agent killswitch"}:k?{loading:!1,hasAccess:!1,accessDeniedReason:"User is UBB Banned"}:"error"===n.status?{loading:!1,hasAccess:!1,accessDeniedReason:"Error determining budget"}:Y.paidAgent.isAuthorized||Y.paidAgent.code!==r.JB.InsufficientBudget?Y.paidAgent.isAuthorized||Y.freeAgent.isAuthorized||!D?Y.freeAgent.isAuthorized||Y.freeAgent.code!==r.JB.RequiresEmailVerification?!R||(null==_?void 0:_.isUnderQuota)?"data"===x.type&&x.shouldBlockReplForm?{loading:!1,hasAccess:!1,accessDeniedReason:"Free Repl limit exceeded"}:C&&R?{loading:!1,hasAccess:!1,accessDeniedReason:"Freemium temporarily unavailable"}:Y.paidAgent.code===r.JB.RequiresPaymentMethod?{loading:!1,hasAccess:!1,accessDeniedReason:"Requires payment method"}:Y.paidAgent.code===r.JB.PaymentDelinquent?{loading:!1,hasAccess:!1,accessDeniedReason:"Failed payment. Update payment method to continue using Agent."}:{loading:!1,hasAccess:!0}:{loading:!1,hasAccess:!1,accessDeniedReason:"Free Agent usage quota exceeded"}:{loading:!1,hasAccess:!1,accessDeniedReason:"Email verification required"}:{loading:!1,hasAccess:!1,accessDeniedReason:"No Repl creation permissions"}:{loading:!1,hasAccess:!1,accessDeniedReason:"Budget exceeded"}}},93203:(e,n,t)=>{t.d(n,{M:()=>Z});var r=t(29935),a=t(17844),i=t(93629),o=t(12694),s=t(82643),l=t(67313),c=t(21462),u=t(12584),d=t(41114),p=t(50175),g=t(86997),m=t(70883),h=t(78638);function f(){var e=(0,u._)(["\n  mutation CreateAgentReplCreateRepl($input: CreateReplInput!) {\n    createRepl(input: $input, isTitleAutoGenerated: false) {\n      ... on Repl {\n        id\n        ...ReplLinkRepl\n        ...CrosisContextRepl\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n  ","\n"]);return f=function(){return e},e}function v(){var e=(0,u._)(["\n  query CreateAgentReplCurrentUser {\n    currentUser {\n      id\n      username\n      ...CrosisContextCurrentUser\n      replCount {\n        ... on ReplCount {\n          count\n        }\n      }\n    }\n  }\n  ","\n"]);return v=function(){return e},e}var w={},y=(0,d.J1)(f(),m.r,h.c),b=(0,d.J1)(v(),h.N),A=t(54393),_=t(90629);function S(){var e=(0,u._)(["\n  mutation GenerateAgentReplIcon($prompt: String!, $replId: String!) {\n    generateReplIcon(input: { prompt: $prompt, replId: $replId }) {\n      ... on GenerateReplIconResult {\n        repl {\n          id\n          iconUrl\n        }\n      }\n    }\n  }\n"]);return S=function(){return e},e}var U={},Y=(0,d.J1)(S()),B=t(22136),E=t(46161),k=t(8950),x=t(32738),I=t(40502),C=t(71983),R=t(21762),D=t(54682),F=t(17089),T=t(39685),P=t(1982),L=t(35073),N=t(35787),O=t(96050),M=t(18427),q=t(74671),H=t(23125),z=t(7733),W=t(37523),V=t(81497),$=t(35995),G=t(97298);function Z(e){var n,t,u,d,m,h,f,v,S,W,V,$,Z,j,J,Q,X,ee=e.currentUser,en=(0,o._)((0,c.useState)("idle"),2),et=en[0],er=en[1],ea=(0,O.pE)("folderId","string"),ei=(0,D.m6)(),eo=(0,P.A)().showError,es=(0,o._)((h=(0,a._)({},w,void 0),p.n(y,h)),1)[0],el=(u=(t=(n=(0,a._)({},w,void 0),g.I(b,n))).data,d=t.error,m=t.loading,d?{loading:!1,currentUser:null,errorCode:500}:(null==u?void 0:u.currentUser)?{loading:!1,currentUser:u.currentUser,errorCode:null}:m?{loading:!0,currentUser:null,errorCode:null}:{loading:!1,currentUser:null,errorCode:403}).currentUser,ec=(0,z.L)(),eu=(0,l.useRouter)(),ed=(0,M.A)(),ep=(0,R._P)({controlName:"flag-killswitch-agent"}),eg=(0,R._P)({controlName:"flag-agent-onboarding-ws"}),em=(0,R._P)({controlName:"flag-visual-plan-creation"}),eh=function(e){er("idle"),eo(e.message),(0,A.B)(e)},ef=(0,o._)((0,c.useState)("disconnected"),2),ev=ef[0],ew=ef[1],ey=(v=(f={currentUserUsername:ee.username,currentUserEmail:ee.email,currentUserTimeCreated:ee.timeCreated,updatePromptConnectionStatus:function(e){ew(e)}}).currentUserUsername,S=f.currentUserEmail,W=f.currentUserTimeCreated,V=f.updatePromptConnectionStatus,$=(0,R._P)({controlName:"flag-repl-creation-slack-bot-events"}),Z=(0,D.m6)(),j=(0,r._)(function(e){var n,t,a,i,o,l,c,u,d,p,g,m,h;return(0,s.YH)(this,function(f){switch(f.label){case 0:return n=e.prompt,t=e.uploadedFiles,a=e.requestedStackBlueprint,i=e.replId,o=e.currentUserId,l=e.orgId,c=(0,B.hV)({currentUserId:o}),(u=new B.Zn({clientId:c,serverId:I.wV,getEndpoint:(0,r._)(function(){var e,n;return(0,s.YH)(this,function(t){switch(t.label){case 0:return[4,(0,I.j2)(i,c,l)];case 1:return e=t.sent(),(n=new URL((0,I.qK)())).searchParams.set("auth_token",e),[2,n]}})}),onProtocolError:function(e){throw Error("Failed to send agent prompt. Protocol error: ".concat(e.message))},onRetriesExceeded:function(){throw Error("Unable to connect. Please try again later.")}})).status.subscribe(function(e){V(e)}),d=(0,E.uc)({sessionType:k.dF3.AGENT_SESSION,replId:i}),[4,u.service.createSession.rpc(d)];case 1:if(!(p=f.sent()).ok)throw Error("Failed to send agent prompt. Session creation failed.");return g=p.payload.sessionId,m=p.payload.sessionCreationEventId,h=(0,x.k)({session:g,parent:m,model:k.e3q.ADVANCED,sender:{id:o,membership:k.VMq.CORE,timeCreated:new Date(W)},addToChild:!1,data:{kind:"message",message:n,uploadedFiles:t,requestedStackBlueprint:a,intent:k.qRv.AGENT}}),u.service.createEvent.rpc(h.request),(0,F.u4)(C.AZ.START_WITH_AI_USED,{action:"created_agent_session",prompt:n,attachments:t,repl_id:i,username:v,email:S,is_mobile:Z,has_agent:!0,send_to_slack_bot:$,session_id:g,langsmith_url:(0,I.Yd)(g,k.dF3.AGENT_SESSION)}),(0,T.p)({action:"created_new_session",sessionId:g}),[2]}})}),function(e){return j.apply(this,arguments)}),eb=(X=(0,o._)((J={onError:function(e){_.Cp(e)}},Q=(0,a._)({},U,J),p.n(Y,Q)),1)[0],function(e){var n=e.prompt,t=e.attachments,r=e.replId;X({variables:{prompt:n+(t.length>0?"\n\nWith attachments: ".concat(t.map(function(e){return e.path}).join(", ")):""),replId:r}})});function eA(){return(eA=(0,r._)(function(e){var n,t,r,o,l,c,u,d,p,g,m,h,f,v;return(0,s.YH)(this,function(s){switch(s.label){case 0:if(n=e.prompt,t=e.attachments,r=e.requestedStackBlueprint,o=e.isPrivate,l=e.teamId,c=e.orgId,ep)return eo("This feature is currently unavailable."),er("idle"),[2];return(0,N.O7)(),[4,(0,L.u9)()];case 1:return s.sent(),er("creating_repl"),[4,es({variables:{input:{aiPromptText:n,aiPromptAttachmentPaths:t.map(function(e){return e.path}),folderId:ea,isPrivate:o,teamId:l,orgId:c,isVisualPlanCreationEnabled:em}}})];case 2:if((u=s.sent()).errors)return eh(Error(u.errors.map(function(e){return e.message}).join(", "))),[2];if(!u.data)return eh(Error("Expected data from createRepl graphql mutation")),[2];if("message"in u.data.createRepl)return eh(Error(u.data.createRepl.message)),[2];if(d=u.data.createRepl,eb({prompt:n,attachments:t,replId:d.id}),!(p=t&&t.length>0))return[3,4];return g=(0,H.O)({repl:d,currentUser:el}),(m=(0,q.Ay)({onUnrecoverableError:function(e){er("idle"),eo(e.message)}})).connect({context:g,getMinimumRetryDelayMs:ec}),er("configuring_repl"),[4,function(e){return K.apply(this,arguments)}({hasAttachments:p,attachments:t,container:m,handleError:eh})];case 3:s.sent(),s.label=4;case 4:return s.trys.push([4,6,,7]),[4,ey({prompt:n,uploadedFiles:t.map(function(e){return{path:e.path,mimeType:e.file.type}}),requestedStackBlueprint:r,replId:d.id,currentUserId:ee.id,orgId:c})];case 5:return s.sent(),[3,7];case 6:return eh((h=s.sent())instanceof Error?h:Error(String(h))),[2];case 7:if(er("opening_repl"),f={enterInAgentMode:!0,agentOnboarding:(null==el?void 0:el.replCount.__typename)==="ReplCount"&&(null==el?void 0:el.replCount.count)===0&&eg},v=(0,G.q1)(d,f),!ei)return[3,8];return window.location.href=(0,G.cY)(d,f),[3,10];case 8:return[4,eu.push((0,i._)((0,a._)({},v.href),{pathname:ed}),v.as)];case 9:s.sent(),s.label=10;case 10:return er("idle"),[2]}})})).apply(this,arguments)}return{createAgentRepl:function(e){return eA.apply(this,arguments)},status:et,agentPromptRiverConnectionStatus:ev}}function K(){return(K=(0,r._)(function(e){var n,t,r,a,i;return(0,s.YH)(this,function(o){switch(o.label){case 0:if(n=e.hasAttachments,t=e.container,r=e.attachments,a=e.handleError,!n)return[2];return i=(0,W.A)({container:t}),[4,(0,V.Zn)({parentPath:$.Ls,files:r.map(function(e){return e.file}),fs:i,onError:function(e){a(Error("Error uploading ".concat(e.path,": ").concat(e.error)))}})];case 1:return o.sent(),[2]}})})).apply(this,arguments)}},94301:(e,n,t)=>{t.d(n,{uJ:()=>A,jQ:()=>S});var r=t(17844),a=t(12584),i=t(41114),o=t(86997);function s(){var e=(0,a._)(["\n  fragment AiProviderCurrentUser on CurrentUser {\n    id\n    timeCreated\n  }\n"]);return s=function(){return e},e}var l=(0,i.J1)(s()),c=t(56199),u=t(44753);function d(){var e=(0,a._)(["\n  fragment StartWithAiOrgMetadata on Org {\n    id\n    name\n  }\n"]);return d=function(){return e},e}function p(){var e=(0,a._)(["\n  fragment StartWithAiUsageBudget on UsageBasedBillingBudget {\n    id\n    hasReachedBudget\n  }\n"]);return p=function(){return e},e}function g(){var e=(0,a._)(["\n  fragment StartWithAiOrgUsageLimitAuthorization on OrgAuthorizations {\n    editUsageLimit {\n      isAuthorized\n      message\n    }\n  }\n"]);return g=function(){return e},e}function m(){var e=(0,a._)(["\n  query StartWithAi {\n    currentUser {\n      id\n      username\n      firstName\n      email\n      isVerified\n      ...AiProviderCurrentUser\n      ...ReplOwnerCurrentUser\n    }\n  }\n  ","\n  ","\n"]);return m=function(){return e},e}function h(){var e=(0,a._)(["\n  query StartWithAiUsageLimits($orgId: String) {\n    currentUser {\n      id\n      usageBasedBillingBudget {\n        __typename\n        ... on UsageBasedBillingBudget {\n          ...StartWithAiUsageBudget\n        }\n        ... on Error {\n          message\n        }\n      }\n      usageBasedBillingAlerts {\n        ...EditUsageBasedBillingAlertsFormInitialConfig\n      }\n      org(orgId: $orgId) {\n        __typename\n        ... on Org {\n          ...StartWithAiOrgMetadata\n          authorizations {\n            ...StartWithAiOrgUsageLimitAuthorization\n          }\n          groups(input: { types: [system_viewers] }) {\n            ... on OrgGroupConnection {\n              items {\n                id\n                type\n                isMember\n              }\n            }\n          }\n          usageBasedBillingBudget {\n            __typename\n            ... on UsageBasedBillingBudget {\n              ...StartWithAiUsageBudget\n            }\n            ... on Error {\n              message\n            }\n          }\n          usageBasedBillingAlerts {\n            ...EditUsageBasedBillingAlertsFormInitialConfig\n          }\n        }\n        ... on Error {\n          message\n        }\n      }\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n"]);return h=function(){return e},e}var f={},v=(0,i.J1)(d()),w=(0,i.J1)(p()),y=(0,i.J1)(g()),b=(0,i.J1)(m(),l,u.nM);function A(e){var n=(0,r._)({},f,e);return o.I(b,n)}var _=(0,i.J1)(h(),w,c.B9,v,y);function S(e){var n=(0,r._)({},f,e);return o.I(_,n)}},94887:(e,n,t)=>{t.d(n,{A:()=>s});var r=t(17844),a=t(93629),i=t(81073),o=t(52351);function s(e){return(0,i.Y)(o.Ay,(0,a._)((0,r._)({},e),{children:(0,i.Y)("path",{fillRule:"evenodd",d:"M9 2.25a.75.75 0 0 1 .712.513L15 18.628l2.288-6.865A.75.75 0 0 1 18 11.25h4a.75.75 0 0 1 0 1.5h-3.46l-2.828 8.487a.75.75 0 0 1-1.423 0L9 5.372l-2.288 6.865A.75.75 0 0 1 6 12.75H2a.75.75 0 0 1 0-1.5h3.46l2.828-8.487A.75.75 0 0 1 9 2.25Z",clipRule:"evenodd"})}))}}}]);
//# sourceMappingURL=7940-35c718bafeceed61.js.map